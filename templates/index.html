<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Latest Summaries</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="deck">
    {% for article in articles %}
      <div class="card" data-state="0" data-article-id="{{ article.id }}">
        <div class="card-inner">
          <!-- Front of the card -->
          <div class="card-front">
            <div class="card-title-container {{ 'fp-title' if article.source == 'Foreign Policy' else 'fa-title' }}">
              <h2 class="card-title">{{ article.title }}</h2>
              <p class="article-source">{{ article.source }} — {{ article.author }}</p>
              <span class="article-date">{% set month_map = {
                '01': 'January',
                '02': 'February',
                '03': 'March',
                '04': 'April',
                '05': 'May',
                '06': 'June',
                '07': 'July',
                '08': 'August',
                '09': 'September',
                '10': 'October',
                '11': 'November',
                '12': 'December'
              } %}
              {% set date_text = article.date_added.split(' ')[0] %}
              {% set parts = date_text.split('-') %}
              {{ month_map[parts[1]] }} {{ parts[2].lstrip('0') }}</span>
            </div>
            <div class="card-content">
              <p>{{ article.core_thesis }}</p>
            </div>
          </div>
          <!-- Back of the card -->
          <div class="card-back">
            <div class="card-title-container {{ 'fp-title' if article.source == 'Foreign Policy' else 'fa-title' }}">
              <h2 class="card-title">{{ article.title }}</h2>
              <p class="article-source">{{ article.source }} — {{ article.author }}</p>
              <span class="article-date">{% set month_map = {
                '01': 'January',
                '02': 'February',
                '03': 'March',
                '04': 'April',
                '05': 'May',
                '06': 'June',
                '07': 'July',
                '08': 'August',
                '09': 'September',
                '10': 'October',
                '11': 'November',
                '12': 'December'
              } %}
              {% set date_text = article.date_added.split(' ')[0] %}
              {% set parts = date_text.split('-') %}
              {{ month_map[parts[1]] }} {{ parts[2].lstrip('0') }}</span>
            </div>
            <div class="card-content">
              <p>{{ article.detailed_abstract }}</p>
              <div class="article-actions">
                <button class="share-button" onclick="shareArticle({{ article.id }})">
                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M18 8C19.6569 8 21 6.65685 21 5C21 3.34315 19.6569 2 18 2C16.3431 2 15 3.34315 15 5C15 6.65685 16.3431 8 18 8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M6 15C7.65685 15 9 13.6569 9 12C9 10.3431 7.65685 9 6 9C4.34315 9 3 10.3431 3 12C3 13.6569 4.34315 15 6 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M18 22C19.6569 22 21 20.6569 21 19C21 17.3431 19.6569 16 18 16C16.3431 16 15 17.3431 15 19C15 20.6569 16.3431 22 18 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M8.59 13.51L15.42 17.49" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M15.41 6.51L8.59 10.49" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </button>
                <div class="article-link">
                  <a href="{{ article.url }}" target="_blank" rel="noopener noreferrer">read full article on {{ 'foreignpolicy.com' if article.source == 'Foreign Policy' else 'foreignaffairs.com' }}</a>
                </div>
              </div>
              <div class="quotes-section">
                <ul>
                  {% for quote in article.supporting_data_quotes.split('*') %}
                      {% if quote.strip() %}
                          <li>{{ quote.strip() }}</li>
                      {% endif %}
                  {% endfor %}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
  <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
